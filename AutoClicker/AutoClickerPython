import tkinter as tk
from tkinter import ttk
import pyautogui
import autopy
import threading
import time

class AutoClicker:
    def __init__(self, root):
        self.root = root
        self.root.title("Auto Clicker")
        self.root.geometry("400x300")
        
        # Style for a professional look
        self.style = ttk.Style()
        self.style.configure("TLabel", font=("Arial", 12))
        self.style.configure("TButton", font=("Arial", 12))
        self.style.configure("TEntry", font=("Arial", 12))
        
        # Interval Label and Entry
        self.interval_label = ttk.Label(root, text="Click Interval (seconds):")
        self.interval_label.pack(pady=10)
        
        self.interval_entry = ttk.Entry(root)
        self.interval_entry.pack(pady=5)
        
        # Start and Stop Buttons
        self.start_button = ttk.Button(root, text="Start Clicking", command=self.start_clicking)
        self.start_button.pack(pady=10)
        
        self.stop_button = ttk.Button(root, text="Stop Clicking", command=self.stop_clicking)
        self.stop_button.pack(pady=5)
        
        # Move Mouse Button
        self.move_mouse_button = ttk.Button(root, text="Move Mouse to (500, 500)", command=self.move_mouse)
        self.move_mouse_button.pack(pady=10)
        
        # Status Label
        self.status_label = ttk.Label(root, text="Status: Idle")
        self.status_label.pack(pady=10)
        
        self.clicking = False

    def start_clicking(self):
        try:
            interval = float(self.interval_entry.get())
            if interval <= 0:
                self.status_label.config(text="Status: Interval must be positive")
                return
        except ValueError:
            self.status_label.config(text="Status: Invalid interval")
            return
        
        self.clicking = True
        self.status_label.config(text="Status: Clicking...")
        threading.Thread(target=self.clicker, args=(interval,), daemon=True).start()

    def stop_clicking(self):
        self.clicking = False
        self.status_label.config(text="Status: Stopped")

    def clicker(self, interval):
        while self.clicking:
            pyautogui.click()
            time.sleep(interval)

    def move_mouse(self):
        autopy.mouse.move(500, 500)
        self.status_label.config(text="Status: Mouse moved to (500, 500)")

if __name__ == "__main__":
    root = tk.Tk()
    app = AutoClicker(root)
    root.mainloop()